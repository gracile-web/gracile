{"version":3,"file":"document.js","sources":["../../../../../../packages/client/dist/polyfills/request-idle-callback.raw.js","../../../../../../packages/server/dist/document.js","../../../src/document.ts"],"sourcesContent":["/* eslint-disable func-names */\n// Taken from: https://github.com/pladaria/requestidlecallback-polyfill/blob/master/index.js\nexport const requestIdleCallback = `\nwindow.requestIdleCallback =\n\twindow.requestIdleCallback ||\n\tfunction (cb) {\n\t\tconst start = Date.now();\n\t\treturn setTimeout(() => {\n\t\t\tcb({\n\t\t\t\tdidTimeout: false,\n\t\t\t\ttimeRemaining: () => {\n\t\t\t\t\treturn Math.max(0, 50 - (Date.now() - start));\n\t\t\t\t},\n\t\t\t});\n\t\t}, 1);\n\t};\n\nwindow.cancelIdleCallback =\n\twindow.cancelIdleCallback ||\n\tfunction (id) {\n\t\tclearTimeout(id);\n\t};\n`;\n","/* eslint-disable import/no-extraneous-dependencies */\nimport { requestIdleCallback } from '@gracile/client/polyfills/request-idle-callback.raw';\nimport { pageAssets } from '@gracile/engine/render/route-template';\nimport { html } from '@lit-labs/ssr';\nimport { html as LitHtml, LitElement } from 'lit';\nimport { unsafeHTML } from 'lit/directives/unsafe-html.js';\n// TODO: parametrize for prod/dev (using esm-env? import.meta.ENV? NODE_ENV?â€¦)\nconst errors = html `\n\t<script type=\"module\">\n\t\tif (import.meta.hot) {\n\t\t\timport.meta.hot.on('gracile:ssr-error', (error) => {\n\t\t\t\tthrow new Error(error.message);\n\t\t\t});\n\t\t}\n\t</script>\n`;\nconst fullHydration = html `\n\t<script type=\"module\">\n\t\t// HYDRATE\n\t\timport '@gracile/gracile/hydrate';\n\t</script>\n`;\nconst polyfills = {\n    declarativeShadowDom: html `\n\t\t<script type=\"module\">\n\t\t\t// DECLARATIVE SHADOW DOM\n\t\t\timport '@gracile/gracile/polyfills/declarative-shadow-dom';\n\t\t</script>\n\t`,\n    requestIdleCallback: html `\n\t\t${unsafeHTML(`\n      <script>\n\t\t\t\t// REQUEST IDLE CALLBACK - POLYFILL\n\t\t\t\t${requestIdleCallback}\n      </script>\n\t\t\t`)}\n\t`,\n};\n// ---\nexport const helpers = {\n    fullHydration,\n    polyfills,\n    pageAssets,\n    dev: {\n        // NOTE: Unused for now.\n        errors,\n    },\n    // SSR_OUTLET: SSR_OUTLET_MARKER,\n};\n/**\n * Server-rendered page marker\n */\nclass RouteTemplateOutlet extends LitElement {\n    // eslint-disable-next-line class-methods-use-this\n    render() {\n        return LitHtml `Something went wrong during server side rendering!`;\n    }\n}\n// TODO: Proper typings helper, e.g:\n// export const document: DocumentTemplate<{ ... }> = (options) => html`...`;\n// export type { DocumentTemplate } from '@gracile/engine/routes/route';\n","import { helpers } from '@gracile/gracile/document';\nimport { html } from '@gracile/gracile/server-html';\n\nexport const document = (options: { url: URL; title?: string }) => html`\n\t<!doctype html>\n\t<html lang=\"en\">\n\t\t<head>\n\t\t\t<!-- Helpers -->\n\t\t\t${Object.values(helpers.dev)}\n\t\t\t<!--  -->\n\t\t\t${helpers.fullHydration}\n\t\t\t<!--  -->\n\t\t\t${Object.values(helpers.polyfills)}\n\n\t\t\t<!-- Global assets -->\n\t\t\t<link\n\t\t\t\trel=\"stylesheet\"\n\t\t\t\thref=${new URL('./document.css', import.meta.url).pathname}\n\t\t\t/>\n\t\t\t<script\n\t\t\t\ttype=\"module\"\n\t\t\t\tsrc=${new URL('./document.client.ts', import.meta.url).pathname}\n\t\t\t></script>\n\n\t\t\t<!-- Page assets -->\n\t\t\t${helpers.pageAssets}\n\n\t\t\t<!-- SEO and page metadata -->\n\t\t\t<meta charset=\"UTF-8\" />\n\t\t\t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n\t\t\t<link rel=\"icon\" type=\"image/svg\" href=\"/favicon.svg\" />\n\n\t\t\t<title>${options.title ?? 'Hello Gracile'}</title>\n\t\t</head>\n\n\t\t<body>\n\t\t\t<route-template-outlet></route-template-outlet>\n\t\t</body>\n\t</html>\n`;\n"],"names":["html"],"mappings":";;;;;;AAAA;AACA;AACO,MAAM,mBAAmB,GAAG,CAAC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;ACfD,MAAM,MAAS,GAAA,IAAA,CAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAA,CAAA;AASf,MAAM,aAAgB,GAAA,IAAA,CAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAA,CAAA;AAMtB,MAAM,SAAY,GAAA;AAAA,EACd,oBAAsB,EAAA,IAAA,CAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAA,CAAA;AAAA,EAMtB,mBAAqB,EAAA,IAAA,CAAA;AAAA,EAAA,EACrB,UAAW,CAAA,CAAA;AAAA;AAAA;AAAA,IAAA,EAGT,mBAAmB,CAAA;AAAA;AAAA,GAAA,CAErB,CAAC,CAAA;AAAA,CAAA,CAAA;AAEL,CAAA,CAAA;AAEO,MAAM,OAAU,GAAA;AAAA,EACnB,aAAA;AAAA,EACA,SAAA;AAAA,EACA,UAAA;AAAA,EACA,GAAK,EAAA;AAAA;AAAA,IAED,MAAA;AAAA,GACJ;AAAA;AAEJ,CAAA;;;;;AChDA,IAAA,EAAA,CAAA;AAGO,MAAM,WAAW,CAAC,OAAA,KAA0CA,mBAAI,UAKxC,CAAA,CAAA,2EAAA,EAAA,qBAAA,EAEL,uBAEW,0EAKyB,EAAA,kDAAA,EAIK,kDAI5C,EAAA,4NAAA,EAOqB,iHAxBvC,MAAO,CAAA,MAAA,CAAO,QAAQ,GAAG,CAAA,EAEzB,QAAQ,aAER,EAAA,MAAA,CAAO,MAAO,CAAA,OAAA,CAAQ,SAAS,CAKzB,EAAA,IAAI,IAAI,gBAAkB,EAAA,MAAA,CAAA,IAAA,CAAY,GAAG,CAAE,CAAA,QAAA,EAI5C,IAAI,GAAI,CAAA,sBAAA,EAAwB,YAAY,GAAG,CAAA,CAAE,UAItD,OAAQ,CAAA,UAAA,EAOD,QAAQ,KAAS,IAAA,eAAA;;;;"}